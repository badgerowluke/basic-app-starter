parameters:
- name: vstsFeed
  type: string
  default: ''
- name: configuration
  type: string
  default: 'Release'
- name: artifactName
  type: string
  default: ''
- name: framework
  type: string
  default: 'netcoreapp3.1'

steps:

- task: DotNetCoreCLI@2
  displayName: Restore_All
  inputs:
    command: restore
    projects: '**/*.csproj'
    vstsFeed: '${{ parameters.vstsFeed }}' #make this a conditional

- task: DotNetCoreCLI@2
  displayName: Build_DOTNET
  inputs:
    command: build
    projects: '**/*.csproj'
    arguments: '--no-restore --configuration ${{ parameters.configuration }}'

- task: ArchiveFiles@2
  displayName: Bundle API
  inputs:
    rootFolderOrFile: monolith.app/bin/Release/${{ parameters.framework }}
    includeRootFolder: false
    archiveFile: $(Pipeline.Workspace)/coachesapi/app.zip
    
- task: PublishBuildArtifacts@1
  displayName: 'Publish Artifact'
  inputs:
    PathtoPublish: $(Pipeline.Workspace)/coachesapi/app.zip
    ArtifactName: ${{ parameters.artifactName }}